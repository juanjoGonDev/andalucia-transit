<section
  class="home app-layout__surface app-layout__surface--hero"
  appLayoutContent
  [appLayoutContentNavigationKey]="layoutNavigationKey()"
>
  <div class="utility-container">
    <div class="app-layout__body home__body home__stack">
      <header class="home__header app-hero">
        <div class="app-hero__intro">
          <p class="app-hero__eyebrow">{{ heroEyebrowKey | translate }}</p>
          <h1 class="app-hero__title">{{ headerTaglineKey | translate }}</h1>
          <p class="app-hero__description">{{ heroDescriptionKey | translate }}</p>
        </div>
      </header>

      <main class="home__main home__stack">
        <section class="home__card home__stack" aria-labelledby="homeCardTitle">
          <div class="home__card-header home__stack">
            <div>
              <h2 id="homeCardTitle" class="home__card-title">{{ headerTitleKey | translate }}</h2>
              <p class="home__card-subtitle">{{ heroActionKey | translate }}</p>
            </div>
            <div class="home__tabs" role="tablist" aria-orientation="horizontal">
              <div
                *ngFor="let tab of tabs; let index = index"
                #homeTabButton
                appAccessibleButton
                class="home__tab"
                appAccessibleButtonRole="tab"
                [appAccessibleButtonTabIndex]="resolveTabIndex(tab.id)"
                [attr.tabindex]="resolveTabIndex(tab.id)"
                [attr.aria-selected]="isTabActive(tab.id)"
                [attr.id]="buildTabDomId(tab.id)"
                [attr.aria-controls]="buildPanelDomId(tab.id)"
                (focus)="onTabFocus(tab.id)"
                (keydown)="onTabKeydown($event, index)"
                (appAccessibleButtonActivated)="selectTab(tab.id)"
              >
                {{ tab.labelKey | translate }}
              </div>
            </div>
          </div>
          <div class="home__card-body home__stack">
            <ng-container [ngSwitch]="activeTab()">
              <div
                *ngSwitchCase="'search'"
                class="home__panel home__panel--search home__stack"
                role="tabpanel"
                [attr.id]="buildPanelDomId('search')"
                [attr.aria-labelledby]="buildTabDomId('search')"
                [attr.tabindex]="panelTabIndex"
              >
                <app-route-search-form
                  [initialSelection]="currentSelection$ | async"
                  (selectionConfirmed)="onSelectionConfirmed($event)"
                ></app-route-search-form>
              </div>
              <div
                *ngSwitchCase="'recent'"
                class="home__panel home__panel--recent home__stack"
                role="tabpanel"
                [attr.id]="buildPanelDomId('recent')"
                [attr.aria-labelledby]="buildTabDomId('recent')"
                [attr.tabindex]="panelTabIndex"
              >
                <header class="home__panel-header">
                  <div class="home__panel-heading home__stack">
                    <h3 class="home__panel-title">{{ recentStopsTitleKey | translate }}</h3>
                  </div>
                  <div
                    *ngIf="recentClearActionVisible()"
                    appAccessibleButton
                    class="app-button app-button--ghost home__panel-action"
                    (appAccessibleButtonActivated)="onClearRecentSearches()"
                  >
                    {{ recentStopsClearKey | translate }}
                  </div>
                </header>
                <app-home-recent-searches
                  #recentSearches
                  (itemsStateChange)="onRecentItemsStateChange($event)"
                ></app-home-recent-searches>
              </div>
              <div
                *ngSwitchCase="'favorites'"
                class="home__panel home__panel--favorites home__stack"
                role="tabpanel"
                [attr.id]="buildPanelDomId('favorites')"
                [attr.aria-labelledby]="buildTabDomId('favorites')"
                [attr.tabindex]="panelTabIndex"
              >
                <header class="home__panel-header">
                  <div class="home__panel-heading home__stack">
                    <h3 class="home__panel-title">{{ favoritesTitleKey | translate }}</h3>
                  </div>
                  <div
                    appAccessibleButton
                    class="app-button app-button--ghost home__panel-action"
                    (appAccessibleButtonActivated)="openFavoritesView()"
                  >
                    {{ favoritesActionKey | translate }}
                  </div>
                </header>
                <ng-container *ngIf="hasFavorites(); else favoritesEmpty">
                  <app-home-favorites-preview
                    [favorites]="favoritePreview()"
                    [codeLabel]="favoritesCodeLabelKey | translate"
                    [nucleusLabel]="favoritesNucleusLabelKey | translate"
                    (favoriteSelected)="openFavorite($event)"
                  ></app-home-favorites-preview>
                </ng-container>
                <ng-template #favoritesEmpty>
                  <p class="home-recent__empty">{{ favoritesEmptyKey | translate }}</p>
                </ng-template>
              </div>
            </ng-container>
          </div>
        </section>
      </main>
    </div>
  </div>
</section>
